{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/lib/dbConnect.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst MONGODB_URI = process.env.MONGODB_URI!;\r\n\r\nif (!MONGODB_URI) {\r\n  throw new Error(\r\n    \"Please define the MONGODB_URI environment variable inside .env.local\"\r\n  );\r\n}\r\n\r\ninterface MongooseCache {\r\n  conn: typeof mongoose | null;\r\n  promise: Promise<typeof mongoose> | null;\r\n}\r\n\r\ndeclare global {\r\n  var mongoose: MongooseCache | undefined;\r\n}\r\n\r\nlet cached: MongooseCache = global.mongoose || { conn: null, promise: null };\r\n\r\nif (!global.mongoose) {\r\n  global.mongoose = cached;\r\n}\r\n\r\nasync function dbConnect(): Promise<typeof mongoose> {\r\n  if (cached.conn) {\r\n    return cached.conn;\r\n  }\r\n\r\n  if (!cached.promise) {\r\n    const opts = {\r\n      bufferCommands: false,\r\n    };\r\n\r\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\r\n      return mongoose;\r\n    });\r\n  }\r\n\r\n  try {\r\n    cached.conn = await cached.promise;\r\n  } catch (e) {\r\n    cached.promise = null;\r\n    throw e;\r\n  }\r\n\r\n  return cached.conn;\r\n}\r\n\r\nexport default dbConnect;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MACR;AAEJ;AAWA,IAAI,SAAwB,OAAO,QAAQ,IAAI;IAAE,MAAM;IAAM,SAAS;AAAK;AAE3E,IAAI,CAAC,OAAO,QAAQ,EAAE;IACpB,OAAO,QAAQ,GAAG;AACpB;AAEA,eAAe;IACb,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QAEA,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,OAAO;QACT;IACF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB;uCAEe"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/models/User.ts"],"sourcesContent":["import mongoose, { Schema, Document } from \"mongoose\";\r\n\r\nexport interface IUser extends Document {\r\n    email: string;\r\n    password: string;\r\n    telephone: string;\r\n    nin?: string;\r\n    vaultId: mongoose.Types.ObjectId;\r\n    resetToken?: string;\r\n    resetTokenExpiry?: Date;\r\n    // Government Hierarchy\r\n    role: \"citizen\" | \"gov_admin\" | \"gov_official\" | \"gov_associate\";\r\n    organizationId?: mongoose.Types.ObjectId;\r\n    permissions?: string[];\r\n    isActive: boolean;\r\n}\r\n\r\nconst UserSchema = new Schema<IUser>(\r\n    {\r\n        email: { type: String, required: true, unique: true },\r\n        password: { type: String, required: true },\r\n        telephone: { type: String, required: true },\r\n        nin: { type: String, required: false, unique: true, sparse: true },\r\n        vaultId: { type: Schema.Types.ObjectId, ref: \"Vault\", required: true },\r\n        resetToken: { type: String, required: false },\r\n        resetTokenExpiry: { type: Date, required: false },\r\n\r\n        // RBAC Fields\r\n        role: {\r\n            type: String,\r\n            enum: [\"citizen\", \"gov_admin\", \"gov_official\", \"gov_associate\"],\r\n            default: \"citizen\",\r\n            index: true\r\n        },\r\n        organizationId: { type: Schema.Types.ObjectId, ref: \"Organization\" },\r\n        permissions: [{ type: String }], // Granular generic permissions e.g. [\"verify.education\", \"issue.birth_cert\"]\r\n        isActive: { type: Boolean, default: true },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nconst User = mongoose.models.User || mongoose.model<IUser>(\"User\", UserSchema);\r\n\r\nexport default User;\r\n"],"names":[],"mappings":";;;;AAAA;;AAiBA,MAAM,aAAa,IAAI,mHAAM,CACzB;IACI,OAAO;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;IAAK;IACpD,UAAU;QAAE,MAAM;QAAQ,UAAU;IAAK;IACzC,WAAW;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC1C,KAAK;QAAE,MAAM;QAAQ,UAAU;QAAO,QAAQ;QAAM,QAAQ;IAAK;IACjE,SAAS;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAS,UAAU;IAAK;IACrE,YAAY;QAAE,MAAM;QAAQ,UAAU;IAAM;IAC5C,kBAAkB;QAAE,MAAM;QAAM,UAAU;IAAM;IAEhD,cAAc;IACd,MAAM;QACF,MAAM;QACN,MAAM;YAAC;YAAW;YAAa;YAAgB;SAAgB;QAC/D,SAAS;QACT,OAAO;IACX;IACA,gBAAgB;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAe;IACnE,aAAa;QAAC;YAAE,MAAM;QAAO;KAAE;IAC/B,UAAU;QAAE,MAAM;QAAS,SAAS;IAAK;AAC7C,GACA;IAAE,YAAY;AAAK;AAGvB,MAAM,OAAO,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAQ,QAAQ;uCAEpD"}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/lib/rbac.ts"],"sourcesContent":["import { cookies } from \"next/headers\";\r\nimport jwt from \"jsonwebtoken\";\r\nimport dbConnect from \"@/lib/dbConnect\";\r\nimport User, { IUser } from \"@/models/User\";\r\n\r\nexport type Role = \"citizen\" | \"gov_admin\" | \"gov_official\" | \"gov_associate\";\r\n\r\nexport interface SystemUser extends IUser {\r\n    _id: string;\r\n}\r\n\r\n/**\r\n * Retrieves the current authenticated user inside a Server Action or Server Component.\r\n * Returns null if not authenticated or invalid.\r\n */\r\nexport async function getCurrentUser(): Promise<SystemUser | null> {\r\n    const cookieStore = await cookies();\r\n    const token = cookieStore.get(\"token\")?.value;\r\n\r\n    if (!token) return null;\r\n\r\n    try {\r\n        const decoded = jwt.verify(token, process.env.JWT_SECRET!) as { id: string };\r\n        await dbConnect();\r\n        const user = await User.findById(decoded.id).select(\"-password\").lean();\r\n        return user as SystemUser;\r\n    } catch (error) {\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * Enforces that the current user has one of the allowed roles.\r\n * Throws an error if authorization fails (for use in Server Actions).\r\n * Returns the user if successful.\r\n */\r\nexport async function enforceRole(allowedRoles: Role[]): Promise<SystemUser> {\r\n    const user = await getCurrentUser();\r\n\r\n    if (!user) {\r\n        throw new Error(\"Unauthorized: Please log in.\");\r\n    }\r\n\r\n    if (!allowedRoles.includes(user.role as Role)) {\r\n        throw new Error(\"Forbidden: Insufficient permissions.\");\r\n    }\r\n\r\n    return user;\r\n}\r\n\r\n/**\r\n * Soft check for RBAC, returns boolean instead of throwing.\r\n */\r\nexport async function hasRole(allowedRoles: Role[]): Promise<boolean> {\r\n    try {\r\n        const user = await getCurrentUser();\r\n        if (!user) return false;\r\n        return allowedRoles.includes(user.role as Role);\r\n    } catch {\r\n        return false;\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAYO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,yQAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,UAAU;IAExC,IAAI,CAAC,OAAO,OAAO;IAEnB,IAAI;QACA,MAAM,UAAU,yMAAG,CAAC,MAAM,CAAC,OAAO,QAAQ,GAAG,CAAC,UAAU;QACxD,MAAM,IAAA,2HAAS;QACf,MAAM,OAAO,MAAM,yHAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,EAAE,MAAM,CAAC,aAAa,IAAI;QACrE,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,OAAO;IACX;AACJ;AAOO,eAAe,YAAY,YAAoB;IAClD,MAAM,OAAO,MAAM;IAEnB,IAAI,CAAC,MAAM;QACP,MAAM,IAAI,MAAM;IACpB;IAEA,IAAI,CAAC,aAAa,QAAQ,CAAC,KAAK,IAAI,GAAW;QAC3C,MAAM,IAAI,MAAM;IACpB;IAEA,OAAO;AACX;AAKO,eAAe,QAAQ,YAAoB;IAC9C,IAAI;QACA,MAAM,OAAO,MAAM;QACnB,IAAI,CAAC,MAAM,OAAO;QAClB,OAAO,aAAa,QAAQ,CAAC,KAAK,IAAI;IAC1C,EAAE,OAAM;QACJ,OAAO;IACX;AACJ"}},
    {"offset": {"line": 213, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,oOAAO,EAAC,IAAA,8LAAI,EAAC;AACtB"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn('leading-none font-semibold', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn('text-muted-foreground text-sm', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn('px-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 330, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/components/stats-card.tsx"],"sourcesContent":["import type { LucideIcon } from \"lucide-react\"\r\nimport { Card } from \"@/components/ui/card\"\r\nimport { cn } from \"@/lib/utils\"\r\n\r\ninterface StatsCardProps {\r\n  icon: LucideIcon\r\n  label: string\r\n  value: string | number\r\n  change?: string\r\n  trend?: \"up\" | \"down\" | \"neutral\"\r\n  className?: string\r\n}\r\n\r\nexport function StatsCard({ icon: Icon, label, value, change, trend = \"neutral\", className }: StatsCardProps) {\r\n  return (\r\n    <Card className={cn(\"border-border bg-card p-4\", className)}>\r\n      <div className=\"flex items-start justify-between\">\r\n        <div className=\"flex h-10 w-10 items-center justify-center rounded-lg bg-teal/10\">\r\n          <Icon className=\"h-5 w-5 text-teal\" />\r\n        </div>\r\n        {change && (\r\n          <span\r\n            className={cn(\r\n              \"text-xs font-medium\",\r\n              trend === \"up\" && \"text-teal\",\r\n              trend === \"down\" && \"text-destructive\",\r\n              trend === \"neutral\" && \"text-muted-foreground\",\r\n            )}\r\n          >\r\n            {change}\r\n          </span>\r\n        )}\r\n      </div>\r\n      <div className=\"mt-4\">\r\n        <p className=\"text-2xl font-bold text-foreground\">{value}</p>\r\n        <p className=\"text-sm text-muted-foreground\">{label}</p>\r\n      </div>\r\n    </Card>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAWO,SAAS,UAAU,EAAE,MAAM,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,QAAQ,SAAS,EAAE,SAAS,EAAkB;IAC1G,qBACE,6WAAC,iIAAI;QAAC,WAAW,IAAA,kHAAE,EAAC,6BAA6B;;0BAC/C,6WAAC;gBAAI,WAAU;;kCACb,6WAAC;wBAAI,WAAU;kCACb,cAAA,6WAAC;4BAAK,WAAU;;;;;;;;;;;oBAEjB,wBACC,6WAAC;wBACC,WAAW,IAAA,kHAAE,EACX,uBACA,UAAU,QAAQ,aAClB,UAAU,UAAU,oBACpB,UAAU,aAAa;kCAGxB;;;;;;;;;;;;0BAIP,6WAAC;gBAAI,WAAU;;kCACb,6WAAC;wBAAE,WAAU;kCAAsC;;;;;;kCACnD,6WAAC;wBAAE,WAAU;kCAAiC;;;;;;;;;;;;;;;;;;AAItD"}},
    {"offset": {"line": 411, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/models/Organization.ts"],"sourcesContent":["import mongoose, { Schema, Document, model, models } from \"mongoose\";\r\n\r\nexport interface IOrganization extends Document {\r\n    name: string;\r\n    type: \"ministry\" | \"agency\" | \"institution\";\r\n    code: string; // e.g., \"MOE\" for Ministry of Education\r\n    tier: 1 | 2 | 3;\r\n    tags: string[]; // Routing tags, e.g., [\"education\", \"academic\"]\r\n    description?: string;\r\n    website?: string;\r\n    logoUrl?: string;\r\n    createdAt: Date;\r\n    updatedAt: Date;\r\n}\r\n\r\nconst OrganizationSchema = new Schema<IOrganization>(\r\n    {\r\n        name: { type: String, required: true, unique: true },\r\n        type: {\r\n            type: String,\r\n            enum: [\"ministry\", \"agency\", \"institution\"],\r\n            required: true\r\n        },\r\n        code: { type: String, required: true, unique: true, uppercase: true },\r\n        tier: { type: Number, enum: [1, 2, 3], required: true },\r\n        tags: [{ type: String }], // Used for smart routing\r\n        description: { type: String },\r\n        website: { type: String },\r\n        logoUrl: { type: String },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\n// Prevent duplicate model compilation\r\nexport default models.Organization || model<IOrganization>(\"Organization\", OrganizationSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAeA,MAAM,qBAAqB,IAAI,mHAAM,CACjC;IACI,MAAM;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;IAAK;IACnD,MAAM;QACF,MAAM;QACN,MAAM;YAAC;YAAY;YAAU;SAAc;QAC3C,UAAU;IACd;IACA,MAAM;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;QAAM,WAAW;IAAK;IACpE,MAAM;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAG;YAAG;SAAE;QAAE,UAAU;IAAK;IACtD,MAAM;QAAC;YAAE,MAAM;QAAO;KAAE;IACxB,aAAa;QAAE,MAAM;IAAO;IAC5B,SAAS;QAAE,MAAM;IAAO;IACxB,SAAS;QAAE,MAAM;IAAO;AAC5B,GACA;IAAE,YAAY;AAAK;uCAIR,mHAAM,CAAC,YAAY,IAAI,IAAA,kHAAK,EAAgB,gBAAgB"}},
    {"offset": {"line": 469, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/models/AuditLog.ts"],"sourcesContent":["import mongoose, { Schema, Document, model, models } from \"mongoose\";\r\n\r\nexport interface IAuditLog extends Document {\r\n    action: string; // e.g., \"DOCUMENT_UPLOAD\", \"DOCUMENT_VERIFIED\", \"USER_CREATED\"\r\n    actorId: mongoose.Types.ObjectId; // User who performed the action\r\n    actorRole: string; // Snapshot of role at time of action\r\n    targetId?: mongoose.Types.ObjectId; // ID of the object being acted upon (Doc ID, User ID)\r\n    targetModel?: string; // \"Vault\", \"User\", \"Organization\"\r\n    details: Record<string, any>; // Flexible metadata (IP, old value, new value)\r\n    ipAddress?: string;\r\n    userAgent?: string;\r\n    createdAt: Date;\r\n}\r\n\r\nconst AuditLogSchema = new Schema<IAuditLog>(\r\n    {\r\n        action: { type: String, required: true, index: true },\r\n        actorId: { type: Schema.Types.ObjectId, ref: \"User\", required: true, index: true },\r\n        actorRole: { type: String, required: true },\r\n        targetId: { type: Schema.Types.ObjectId, index: true },\r\n        targetModel: { type: String },\r\n        details: { type: Schema.Types.Mixed }, // Flexible JSON\r\n        ipAddress: { type: String },\r\n        userAgent: { type: String },\r\n    },\r\n    { timestamps: { createdAt: true, updatedAt: false } } // Immutable: no update timestamp\r\n);\r\n\r\n// TTL Index: Auto-delete logs after 7 years (compliance) - optional, configured here for 10 years\r\nAuditLogSchema.index({ createdAt: 1 }, { expireAfterSeconds: 315360000 });\r\n\r\nexport default models.AuditLog || model<IAuditLog>(\"AuditLog\", AuditLogSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAcA,MAAM,iBAAiB,IAAI,mHAAM,CAC7B;IACI,QAAQ;QAAE,MAAM;QAAQ,UAAU;QAAM,OAAO;IAAK;IACpD,SAAS;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;QAAM,OAAO;IAAK;IACjF,WAAW;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC1C,UAAU;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,OAAO;IAAK;IACrD,aAAa;QAAE,MAAM;IAAO;IAC5B,SAAS;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,KAAK;IAAC;IACpC,WAAW;QAAE,MAAM;IAAO;IAC1B,WAAW;QAAE,MAAM;IAAO;AAC9B,GACA;IAAE,YAAY;QAAE,WAAW;QAAM,WAAW;IAAM;AAAE,EAAE,iCAAiC;;AAG3F,kGAAkG;AAClG,eAAe,KAAK,CAAC;IAAE,WAAW;AAAE,GAAG;IAAE,oBAAoB;AAAU;uCAExD,mHAAM,CAAC,QAAQ,IAAI,IAAA,kHAAK,EAAY,YAAY"}},
    {"offset": {"line": 525, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/app/dashboard/gov/admin/page.tsx"],"sourcesContent":["import { enforceRole } from \"@/lib/rbac\"\r\nimport { ShieldAlert, Users, FileText, Activity, Building2 } from \"lucide-react\"\r\nimport { Card } from \"@/components/ui/card\"\r\nimport { StatsCard } from \"@/components/stats-card\"\r\nimport Organization from \"@/models/Organization\"\r\nimport User from \"@/models/User\"\r\nimport AuditLog from \"@/models/AuditLog\"\r\nimport dbConnect from \"@/lib/dbConnect\"\r\n\r\nexport default async function AdminDashboardPage() {\r\n    // 1. Enforce Tier 1 Security\r\n    await enforceRole([\"gov_admin\"])\r\n    await dbConnect()\r\n\r\n    // 2. Fetch High-Level Stats\r\n    const totalUsers = await User.countDocuments()\r\n    const govUsers = await User.countDocuments({ role: { $in: [\"gov_official\", \"gov_associate\"] } })\r\n    const totalOrgs = await Organization.countDocuments()\r\n    const recentLogs = await AuditLog.find().sort({ createdAt: -1 }).limit(5).populate(\"actorId\", \"email role\")\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-8 bg-slate-50 min-h-screen\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-slate-900\">National Oversight Dashboard</h1>\r\n                    <p className=\"text-slate-500\">Tier 1 Administration • Republic of Sierra Leone</p>\r\n                </div>\r\n                <div className=\"bg-red-100 text-red-800 px-4 py-2 rounded-full text-sm font-bold flex items-center gap-2\">\r\n                    <ShieldAlert className=\"h-4 w-4\" />\r\n                    ADMIN ACCESS\r\n                </div>\r\n            </div>\r\n\r\n            {/* Stats Grid */}\r\n            <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-4\">\r\n                <StatsCard\r\n                    icon={Users}\r\n                    label=\"Total Citizens\"\r\n                    value={totalUsers}\r\n                    change=\"+12% this week\"\r\n                    trend=\"up\"\r\n                />\r\n                <StatsCard\r\n                    icon={Building2}\r\n                    label=\"Gov Entities\"\r\n                    value={totalOrgs}\r\n                    change=\"Active Ministries\"\r\n                    trend=\"neutral\"\r\n                />\r\n                <StatsCard\r\n                    icon={ShieldAlert}\r\n                    label=\"Gov Officials\"\r\n                    value={govUsers}\r\n                    change=\"Across all tiers\"\r\n                    trend=\"up\"\r\n                />\r\n                <StatsCard\r\n                    icon={Activity}\r\n                    label=\"System Health\"\r\n                    value=\"99.9%\"\r\n                    change=\"Operational\"\r\n                    trend=\"up\"\r\n                />\r\n            </div>\r\n\r\n            {/* Audit Logs Preview */}\r\n            <div className=\"grid gap-8 lg:grid-cols-2\">\r\n                <Card className=\"p-6 border-slate-200 shadow-sm\">\r\n                    <h3 className=\"tex-lg font-bold text-slate-800 mb-4 flex items-center gap-2\">\r\n                        <Activity className=\"h-5 w-5 text-slate-500\" />\r\n                        Recent System Activity\r\n                    </h3>\r\n                    <div className=\"space-y-4\">\r\n                        {recentLogs.length === 0 && <p className=\"text-sm text-slate-500\">No activity logs found.</p>}\r\n                        {recentLogs.map((log: any) => (\r\n                            <div key={log._id} className=\"flex items-start gap-4 p-3 bg-white border border-slate-100 rounded-lg\">\r\n                                <div className=\"h-8 w-8 rounded-full bg-slate-100 flex items-center justify-center text-xs font-bold text-slate-600\">\r\n                                    {log.actorRole === \"gov_admin\" ? \"A\" : \"U\"}\r\n                                </div>\r\n                                <div>\r\n                                    <p className=\"text-sm font-medium text-slate-900\">{log.action}</p>\r\n                                    <p className=\"text-xs text-slate-500\">\r\n                                        by <span className=\"font-mono\">{log.actorId?.email || \"Unknown\"}</span> • {new Date(log.createdAt).toLocaleTimeString()}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </Card>\r\n\r\n                <Card className=\"p-6 border-slate-200 shadow-sm\">\r\n                    <h3 className=\"tex-lg font-bold text-slate-800 mb-4\">Quick Actions</h3>\r\n                    <div className=\"grid gap-4\">\r\n                        <a href=\"/dashboard/gov/admin/organizations\" className=\"w-full text-left p-4 rounded-lg border border-slate-200 hover:border-teal-500 hover:bg-teal-50 transition-all group block\">\r\n                            <h4 className=\"font-semibold text-slate-900 group-hover:text-teal-700\">Manage Organizations</h4>\r\n                            <p className=\"text-sm text-slate-500\">Add or edit Ministries and Institutions</p>\r\n                        </a>\r\n                        <button className=\"w-full text-left p-4 rounded-lg border border-slate-200 hover:border-teal-500 hover:bg-teal-50 transition-all group\">\r\n                            <h4 className=\"font-semibold text-slate-900 group-hover:text-teal-700\">Audit Reports</h4>\r\n                            <p className=\"text-sm text-slate-500\">Generate compliance reports</p>\r\n                        </button>\r\n                        <a href=\"/dashboard/gov/admin/users\" className=\"w-full text-left p-4 rounded-lg border border-slate-200 hover:border-teal-500 hover:bg-teal-50 transition-all group block\">\r\n                            <h4 className=\"font-semibold text-slate-900 group-hover:text-teal-700\">User Management</h4>\r\n                            <p className=\"text-sm text-slate-500\">Suspend or revoke government access</p>\r\n                        </a>\r\n                    </div>\r\n                </Card>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}