{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/models/Document.ts"],"sourcesContent":["import mongoose, { Schema, Document, model, models } from \"mongoose\";\r\n\r\nexport interface IDocument extends Document {\r\n    userId: mongoose.Types.ObjectId; // Citizen Owner\r\n    type: string; // e.g., \"National ID\", \"Birth Certificate\"\r\n    title: string; // User-friendly name\r\n    url?: string; // File path or URL (Optional for requests)\r\n\r\n    // State Machine\r\n    status: \"PENDING_VERIFICATION\" | \"VERIFIED\" | \"ISSUED\" | \"REJECTED\" | \"EXPIRED\" | \"REQUESTED\";\r\n\r\n    // Metadata & AI\r\n    metadata: {\r\n        aiScore?: number;\r\n        aiFlags?: string[];\r\n        aiExplanation?: string;\r\n        extractedText?: string;\r\n        fileHash?: string;\r\n        mimeType?: string;\r\n        sizeBytes?: number;\r\n    };\r\n\r\n    // Government Audit Workflow\r\n    govAudit: {\r\n        uploadedBy?: mongoose.Types.ObjectId; // If Gov issued\r\n        verifiedBy?: mongoose.Types.ObjectId; // Gov User who verified\r\n        verifiedAt?: Date;\r\n        rejectedBy?: mongoose.Types.ObjectId;\r\n        rejectionReason?: string;\r\n        rejectedAt?: Date;\r\n        issuedAt?: Date;\r\n    };\r\n\r\n    createdAt: Date;\r\n    updatedAt: Date;\r\n}\r\n\r\nconst DocumentSchema = new Schema<IDocument>(\r\n    {\r\n        userId: { type: Schema.Types.ObjectId, ref: \"User\", required: true, index: true },\r\n        type: { type: String, required: true, index: true },\r\n        title: { type: String, required: true },\r\n        url: { type: String, required: false },\r\n\r\n        status: {\r\n            type: String,\r\n            enum: [\"PENDING_VERIFICATION\", \"VERIFIED\", \"ISSUED\", \"REJECTED\", \"EXPIRED\", \"REQUESTED\"],\r\n            default: \"PENDING_VERIFICATION\",\r\n            index: true,\r\n        },\r\n\r\n        metadata: {\r\n            aiScore: { type: Number },\r\n            aiFlags: [{ type: String }],\r\n            aiExplanation: { type: String },\r\n            extractedText: { type: String },\r\n            fileHash: { type: String },\r\n            mimeType: { type: String },\r\n            sizeBytes: { type: Number },\r\n        },\r\n\r\n        govAudit: {\r\n            uploadedBy: { type: Schema.Types.ObjectId, ref: \"User\" },\r\n            verifiedBy: { type: Schema.Types.ObjectId, ref: \"User\" },\r\n            verifiedAt: { type: Date },\r\n            rejectedBy: { type: Schema.Types.ObjectId, ref: \"User\" },\r\n            rejectionReason: { type: String },\r\n            rejectedAt: { type: Date },\r\n            issuedAt: { type: Date },\r\n        },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\n// Indexes for common queries\r\nDocumentSchema.index({ \"govAudit.verifiedBy\": 1 });\r\nDocumentSchema.index({ createdAt: -1 });\r\n\r\nexport default models.Document || model<IDocument>(\"Document\", DocumentSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAqCA,MAAM,iBAAiB,IAAI,mHAAM,CAC7B;IACI,QAAQ;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;QAAM,OAAO;IAAK;IAChF,MAAM;QAAE,MAAM;QAAQ,UAAU;QAAM,OAAO;IAAK;IAClD,OAAO;QAAE,MAAM;QAAQ,UAAU;IAAK;IACtC,KAAK;QAAE,MAAM;QAAQ,UAAU;IAAM;IAErC,QAAQ;QACJ,MAAM;QACN,MAAM;YAAC;YAAwB;YAAY;YAAU;YAAY;YAAW;SAAY;QACxF,SAAS;QACT,OAAO;IACX;IAEA,UAAU;QACN,SAAS;YAAE,MAAM;QAAO;QACxB,SAAS;YAAC;gBAAE,MAAM;YAAO;SAAE;QAC3B,eAAe;YAAE,MAAM;QAAO;QAC9B,eAAe;YAAE,MAAM;QAAO;QAC9B,UAAU;YAAE,MAAM;QAAO;QACzB,UAAU;YAAE,MAAM;QAAO;QACzB,WAAW;YAAE,MAAM;QAAO;IAC9B;IAEA,UAAU;QACN,YAAY;YAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAAE,KAAK;QAAO;QACvD,YAAY;YAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAAE,KAAK;QAAO;QACvD,YAAY;YAAE,MAAM;QAAK;QACzB,YAAY;YAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;YAAE,KAAK;QAAO;QACvD,iBAAiB;YAAE,MAAM;QAAO;QAChC,YAAY;YAAE,MAAM;QAAK;QACzB,UAAU;YAAE,MAAM;QAAK;IAC3B;AACJ,GACA;IAAE,YAAY;AAAK;AAGvB,6BAA6B;AAC7B,eAAe,KAAK,CAAC;IAAE,uBAAuB;AAAE;AAChD,eAAe,KAAK,CAAC;IAAE,WAAW,CAAC;AAAE;uCAEtB,mHAAM,CAAC,QAAQ,IAAI,IAAA,kHAAK,EAAY,YAAY"}}]
}