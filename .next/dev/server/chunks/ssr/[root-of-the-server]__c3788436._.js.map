{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/lib/dbConnect.ts"],"sourcesContent":["import mongoose from \"mongoose\";\r\n\r\nconst MONGODB_URI = process.env.MONGODB_URI!;\r\n\r\nif (!MONGODB_URI) {\r\n  throw new Error(\r\n    \"Please define the MONGODB_URI environment variable inside .env.local\"\r\n  );\r\n}\r\n\r\ninterface MongooseCache {\r\n  conn: typeof mongoose | null;\r\n  promise: Promise<typeof mongoose> | null;\r\n}\r\n\r\ndeclare global {\r\n  var mongoose: MongooseCache | undefined;\r\n}\r\n\r\nlet cached: MongooseCache = global.mongoose || { conn: null, promise: null };\r\n\r\nif (!global.mongoose) {\r\n  global.mongoose = cached;\r\n}\r\n\r\nasync function dbConnect(): Promise<typeof mongoose> {\r\n  if (cached.conn) {\r\n    return cached.conn;\r\n  }\r\n\r\n  if (!cached.promise) {\r\n    const opts = {\r\n      bufferCommands: false,\r\n    };\r\n\r\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\r\n      return mongoose;\r\n    });\r\n  }\r\n\r\n  try {\r\n    cached.conn = await cached.promise;\r\n  } catch (e) {\r\n    cached.promise = null;\r\n    throw e;\r\n  }\r\n\r\n  return cached.conn;\r\n}\r\n\r\nexport default dbConnect;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW;AAE3C,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MACR;AAEJ;AAWA,IAAI,SAAwB,OAAO,QAAQ,IAAI;IAAE,MAAM;IAAM,SAAS;AAAK;AAE3E,IAAI,CAAC,OAAO,QAAQ,EAAE;IACpB,OAAO,QAAQ,GAAG;AACpB;AAEA,eAAe;IACb,IAAI,OAAO,IAAI,EAAE;QACf,OAAO,OAAO,IAAI;IACpB;IAEA,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QAEA,OAAO,OAAO,GAAG,oHAAQ,CAAC,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,OAAO;QACT;IACF;IAEA,IAAI;QACF,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IACpC,EAAE,OAAO,GAAG;QACV,OAAO,OAAO,GAAG;QACjB,MAAM;IACR;IAEA,OAAO,OAAO,IAAI;AACpB;uCAEe"}},
    {"offset": {"line": 92, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/models/User.ts"],"sourcesContent":["import mongoose, { Schema, Document } from \"mongoose\";\r\n\r\nexport interface IUser extends Document {\r\n    email: string;\r\n    password: string;\r\n    telephone: string;\r\n    nin?: string;\r\n    vaultId: mongoose.Types.ObjectId;\r\n    resetToken?: string;\r\n    resetTokenExpiry?: Date;\r\n    // Government Hierarchy\r\n    role: \"citizen\" | \"gov_admin\" | \"gov_official\" | \"gov_associate\";\r\n    organizationId?: mongoose.Types.ObjectId;\r\n    permissions?: string[];\r\n    isActive: boolean;\r\n}\r\n\r\nconst UserSchema = new Schema<IUser>(\r\n    {\r\n        email: { type: String, required: true, unique: true },\r\n        password: { type: String, required: true },\r\n        telephone: { type: String, required: true },\r\n        nin: { type: String, required: false, unique: true, sparse: true },\r\n        vaultId: { type: Schema.Types.ObjectId, ref: \"Vault\", required: true },\r\n        resetToken: { type: String, required: false },\r\n        resetTokenExpiry: { type: Date, required: false },\r\n\r\n        // RBAC Fields\r\n        role: {\r\n            type: String,\r\n            enum: [\"citizen\", \"gov_admin\", \"gov_official\", \"gov_associate\"],\r\n            default: \"citizen\",\r\n            index: true\r\n        },\r\n        organizationId: { type: Schema.Types.ObjectId, ref: \"Organization\" },\r\n        permissions: [{ type: String }], // Granular generic permissions e.g. [\"verify.education\", \"issue.birth_cert\"]\r\n        isActive: { type: Boolean, default: true },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nconst User = mongoose.models.User || mongoose.model<IUser>(\"User\", UserSchema);\r\n\r\nexport default User;\r\n"],"names":[],"mappings":";;;;AAAA;;AAiBA,MAAM,aAAa,IAAI,mHAAM,CACzB;IACI,OAAO;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;IAAK;IACpD,UAAU;QAAE,MAAM;QAAQ,UAAU;IAAK;IACzC,WAAW;QAAE,MAAM;QAAQ,UAAU;IAAK;IAC1C,KAAK;QAAE,MAAM;QAAQ,UAAU;QAAO,QAAQ;QAAM,QAAQ;IAAK;IACjE,SAAS;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAS,UAAU;IAAK;IACrE,YAAY;QAAE,MAAM;QAAQ,UAAU;IAAM;IAC5C,kBAAkB;QAAE,MAAM;QAAM,UAAU;IAAM;IAEhD,cAAc;IACd,MAAM;QACF,MAAM;QACN,MAAM;YAAC;YAAW;YAAa;YAAgB;SAAgB;QAC/D,SAAS;QACT,OAAO;IACX;IACA,gBAAgB;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAe;IACnE,aAAa;QAAC;YAAE,MAAM;QAAO;KAAE;IAC/B,UAAU;QAAE,MAAM;QAAS,SAAS;IAAK;AAC7C,GACA;IAAE,YAAY;AAAK;AAGvB,MAAM,OAAO,oHAAQ,CAAC,MAAM,CAAC,IAAI,IAAI,oHAAQ,CAAC,KAAK,CAAQ,QAAQ;uCAEpD"}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/lib/rbac.ts"],"sourcesContent":["import { cookies } from \"next/headers\";\r\nimport jwt from \"jsonwebtoken\";\r\nimport dbConnect from \"@/lib/dbConnect\";\r\nimport User, { IUser } from \"@/models/User\";\r\n\r\nexport type Role = \"citizen\" | \"gov_admin\" | \"gov_official\" | \"gov_associate\";\r\n\r\nexport interface SystemUser extends IUser {\r\n    _id: string;\r\n}\r\n\r\n/**\r\n * Retrieves the current authenticated user inside a Server Action or Server Component.\r\n * Returns null if not authenticated or invalid.\r\n */\r\nexport async function getCurrentUser(): Promise<SystemUser | null> {\r\n    const cookieStore = await cookies();\r\n    const token = cookieStore.get(\"token\")?.value;\r\n\r\n    if (!token) return null;\r\n\r\n    try {\r\n        const decoded = jwt.verify(token, process.env.JWT_SECRET!) as { id: string };\r\n        await dbConnect();\r\n        const user = await User.findById(decoded.id).select(\"-password\").lean();\r\n        return user as SystemUser;\r\n    } catch (error) {\r\n        return null;\r\n    }\r\n}\r\n\r\n/**\r\n * Enforces that the current user has one of the allowed roles.\r\n * Throws an error if authorization fails (for use in Server Actions).\r\n * Returns the user if successful.\r\n */\r\nexport async function enforceRole(allowedRoles: Role[]): Promise<SystemUser> {\r\n    const user = await getCurrentUser();\r\n\r\n    if (!user) {\r\n        throw new Error(\"Unauthorized: Please log in.\");\r\n    }\r\n\r\n    if (!allowedRoles.includes(user.role as Role)) {\r\n        throw new Error(\"Forbidden: Insufficient permissions.\");\r\n    }\r\n\r\n    return user;\r\n}\r\n\r\n/**\r\n * Soft check for RBAC, returns boolean instead of throwing.\r\n */\r\nexport async function hasRole(allowedRoles: Role[]): Promise<boolean> {\r\n    try {\r\n        const user = await getCurrentUser();\r\n        if (!user) return false;\r\n        return allowedRoles.includes(user.role as Role);\r\n    } catch {\r\n        return false;\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;;;;;AAYO,eAAe;IAClB,MAAM,cAAc,MAAM,IAAA,yQAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,UAAU;IAExC,IAAI,CAAC,OAAO,OAAO;IAEnB,IAAI;QACA,MAAM,UAAU,yMAAG,CAAC,MAAM,CAAC,OAAO,QAAQ,GAAG,CAAC,UAAU;QACxD,MAAM,IAAA,2HAAS;QACf,MAAM,OAAO,MAAM,yHAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,EAAE,MAAM,CAAC,aAAa,IAAI;QACrE,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,OAAO;IACX;AACJ;AAOO,eAAe,YAAY,YAAoB;IAClD,MAAM,OAAO,MAAM;IAEnB,IAAI,CAAC,MAAM;QACP,MAAM,IAAI,MAAM;IACpB;IAEA,IAAI,CAAC,aAAa,QAAQ,CAAC,KAAK,IAAI,GAAW;QAC3C,MAAM,IAAI,MAAM;IACpB;IAEA,OAAO;AACX;AAKO,eAAe,QAAQ,YAAoB;IAC9C,IAAI;QACA,MAAM,OAAO,MAAM;QACnB,IAAI,CAAC,MAAM,OAAO;QAClB,OAAO,aAAa,QAAQ,CAAC,KAAK,IAAI;IAC1C,EAAE,OAAM;QACJ,OAAO;IACX;AACJ"}},
    {"offset": {"line": 217, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/models/Vault.ts"],"sourcesContent":["import mongoose, { Schema, Document, model, models } from \"mongoose\";\r\n\r\nexport interface IVaultDocument {\r\n    _id: mongoose.Types.ObjectId;\r\n    label: string;\r\n    url: string;\r\n    type: string;\r\n    uploadedAt: Date;\r\n    blockchainHash?: string;\r\n    // Government Fields\r\n    uploadedBy?: mongoose.Types.ObjectId; // User ID of Uploader (Tier 2/3)\r\n    organizationId?: mongoose.Types.ObjectId; // Organization that issued it\r\n    verifiedBy?: mongoose.Types.ObjectId; // User ID of Verifier (Tier 2)\r\n    verifiedAt?: Date;\r\n    status: \"pending\" | \"verified\" | \"rejected\";\r\n    rejectionReason?: string;\r\n    tags?: string[]; // For smart routing (e.g. [\"education\"])\r\n}\r\n\r\nexport interface IVault extends Document {\r\n    userId?: mongoose.Types.ObjectId;\r\n    documents: IVaultDocument[];\r\n}\r\n\r\nconst DocumentSchema = new Schema<IVaultDocument>(\r\n    {\r\n        label: { type: String, required: true },\r\n        url: { type: String, required: true },\r\n        type: { type: String, required: true }, // Mimetype or Doc Type\r\n        uploadedAt: { type: Date, default: Date.now },\r\n        blockchainHash: { type: String },\r\n\r\n        // Government Workflow\r\n        uploadedBy: { type: Schema.Types.ObjectId, ref: \"User\" },\r\n        organizationId: { type: Schema.Types.ObjectId, ref: \"Organization\" },\r\n        verifiedBy: { type: Schema.Types.ObjectId, ref: \"User\" },\r\n        verifiedAt: { type: Date },\r\n        status: {\r\n            type: String,\r\n            enum: [\"pending\", \"verified\", \"rejected\"],\r\n            default: \"verified\" // Default verified for legacy/self-uploaded docs? Or \"pending\"? keeping verified for backward compat for now, but user docs should be auto-verified if self-uploaded? No, self-uploaded are \"personal\". Gov docs are \"pending\" -> \"verified\".\r\n            // Let's set default to \"verified\" for now so existing docs don't break, but new gov flow will control this explicitly.\r\n        },\r\n        rejectionReason: { type: String },\r\n        tags: [{ type: String }],\r\n    },\r\n    { _id: true }\r\n);\r\n\r\nconst VaultSchema = new Schema<IVault>(\r\n    {\r\n        userId: { type: Schema.Types.ObjectId, ref: \"User\", required: false, index: true },\r\n        documents: [DocumentSchema],\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\nexport default models.Vault || model<IVault>(\"Vault\", VaultSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAwBA,MAAM,iBAAiB,IAAI,mHAAM,CAC7B;IACI,OAAO;QAAE,MAAM;QAAQ,UAAU;IAAK;IACtC,KAAK;QAAE,MAAM;QAAQ,UAAU;IAAK;IACpC,MAAM;QAAE,MAAM;QAAQ,UAAU;IAAK;IACrC,YAAY;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;IAC5C,gBAAgB;QAAE,MAAM;IAAO;IAE/B,sBAAsB;IACtB,YAAY;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAO;IACvD,gBAAgB;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAe;IACnE,YAAY;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;IAAO;IACvD,YAAY;QAAE,MAAM;IAAK;IACzB,QAAQ;QACJ,MAAM;QACN,MAAM;YAAC;YAAW;YAAY;SAAW;QACzC,SAAS,WAAW,8OAA8O;IAEtQ;IACA,iBAAiB;QAAE,MAAM;IAAO;IAChC,MAAM;QAAC;YAAE,MAAM;QAAO;KAAE;AAC5B,GACA;IAAE,KAAK;AAAK;AAGhB,MAAM,cAAc,IAAI,mHAAM,CAC1B;IACI,QAAQ;QAAE,MAAM,mHAAM,CAAC,KAAK,CAAC,QAAQ;QAAE,KAAK;QAAQ,UAAU;QAAO,OAAO;IAAK;IACjF,WAAW;QAAC;KAAe;AAC/B,GACA;IAAE,YAAY;AAAK;uCAGR,mHAAM,CAAC,KAAK,IAAI,IAAA,kHAAK,EAAS,SAAS"}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/models/Organization.ts"],"sourcesContent":["import mongoose, { Schema, Document, model, models } from \"mongoose\";\r\n\r\nexport interface IOrganization extends Document {\r\n    name: string;\r\n    type: \"ministry\" | \"agency\" | \"institution\";\r\n    code: string; // e.g., \"MOE\" for Ministry of Education\r\n    tier: 1 | 2 | 3;\r\n    tags: string[]; // Routing tags, e.g., [\"education\", \"academic\"]\r\n    description?: string;\r\n    website?: string;\r\n    logoUrl?: string;\r\n    createdAt: Date;\r\n    updatedAt: Date;\r\n}\r\n\r\nconst OrganizationSchema = new Schema<IOrganization>(\r\n    {\r\n        name: { type: String, required: true, unique: true },\r\n        type: {\r\n            type: String,\r\n            enum: [\"ministry\", \"agency\", \"institution\"],\r\n            required: true\r\n        },\r\n        code: { type: String, required: true, unique: true, uppercase: true },\r\n        tier: { type: Number, enum: [1, 2, 3], required: true },\r\n        tags: [{ type: String }], // Used for smart routing\r\n        description: { type: String },\r\n        website: { type: String },\r\n        logoUrl: { type: String },\r\n    },\r\n    { timestamps: true }\r\n);\r\n\r\n// Prevent duplicate model compilation\r\nexport default models.Organization || model<IOrganization>(\"Organization\", OrganizationSchema);\r\n"],"names":[],"mappings":";;;;AAAA;;AAeA,MAAM,qBAAqB,IAAI,mHAAM,CACjC;IACI,MAAM;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;IAAK;IACnD,MAAM;QACF,MAAM;QACN,MAAM;YAAC;YAAY;YAAU;SAAc;QAC3C,UAAU;IACd;IACA,MAAM;QAAE,MAAM;QAAQ,UAAU;QAAM,QAAQ;QAAM,WAAW;IAAK;IACpE,MAAM;QAAE,MAAM;QAAQ,MAAM;YAAC;YAAG;YAAG;SAAE;QAAE,UAAU;IAAK;IACtD,MAAM;QAAC;YAAE,MAAM;QAAO;KAAE;IACxB,aAAa;QAAE,MAAM;IAAO;IAC5B,SAAS;QAAE,MAAM;IAAO;IACxB,SAAS;QAAE,MAAM;IAAO;AAC5B,GACA;IAAE,YAAY;AAAK;uCAIR,mHAAM,CAAC,YAAY,IAAI,IAAA,kHAAK,EAAgB,gBAAgB"}},
    {"offset": {"line": 355, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,oOAAO,EAAC,IAAA,8LAAI,EAAC;AACtB"}},
    {"offset": {"line": 370, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-title\"\r\n      className={cn('leading-none font-semibold', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-description\"\r\n      className={cn('text-muted-foreground text-sm', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn('px-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 472, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,kPAAG,EACvB,oZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,4SAAI,GAAG;IAE9B,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 518, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\r\nimport { Slot } from '@radix-ui/react-slot'\r\nimport { cva, type VariantProps } from 'class-variance-authority'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\r\n        destructive:\r\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\r\n        outline:\r\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\r\n        secondary:\r\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\r\n        ghost:\r\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\r\n        link: 'text-primary underline-offset-4 hover:underline',\r\n      },\r\n      size: {\r\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\r\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\r\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\r\n        icon: 'size-9',\r\n        'icon-sm': 'size-8',\r\n        'icon-lg': 'size-10',\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: 'default',\r\n      size: 'default',\r\n    },\r\n  },\r\n)\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<'button'> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean\r\n  }) {\r\n  const Comp = asChild ? Slot : 'button'\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,kPAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,4SAAI,GAAG;IAE9B,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 577, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/app/dashboard/gov/verify/page.tsx"],"sourcesContent":["import { enforceRole } from \"@/lib/rbac\"\r\nimport dbConnect from \"@/lib/dbConnect\"\r\nimport Vault from \"@/models/Vault\"\r\nimport User from \"@/models/User\"\r\nimport Organization from \"@/models/Organization\"\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Check, X, FileText } from \"lucide-react\"\r\n\r\nexport default async function VerificationPage() {\r\n    const user = await enforceRole([\"gov_official\"])\r\n    await dbConnect()\r\n\r\n    // 1. Get Official's Org Tags (e.g. MOE -> [\"education\", \"academic\"])\r\n    const org = await Organization.findById(user.organizationId)\r\n    if (!org) return <div>Organization not found for this user.</div>\r\n\r\n    // 2. Find ALL Vaults containing documents with status 'pending' AND tags matching Org tags\r\n    // This is a simplified \"Smart Routing\" query.\r\n    // In production, you might have a dedicated \"Submission\" collection instead of querying deep into Vaults.\r\n    const relevantTags = org.tags || []\r\n\r\n    // We are looking for documents inside vaults where:\r\n    // status = 'pending'\r\n    // tags IN relevantTags\r\n    const vaults = await Vault.find({\r\n        \"documents\": {\r\n            $elemMatch: {\r\n                status: \"pending\",\r\n                tags: { $in: relevantTags }\r\n            }\r\n        }\r\n    }).lean()\r\n\r\n    // Extract flatter list of tasks\r\n    const tasks = []\r\n    for (const vault of vaults) {\r\n        // Need to find which user owns this vault to display names\r\n        const vaultOwner = await User.findOne({ vaultId: vault._id }).select(\"email nin telephone\")\r\n\r\n        // @ts-ignore\r\n        const pendingDocs = vault.documents.filter(doc =>\r\n            doc.status === 'pending' &&\r\n            doc.tags.some((t: string) => relevantTags.includes(t))\r\n        )\r\n\r\n        for (const doc of pendingDocs) {\r\n            tasks.push({\r\n                // @ts-ignore\r\n                docId: doc._id,\r\n                // @ts-ignore\r\n                title: doc.title,\r\n                // @ts-ignore\r\n                type: doc.type,\r\n                // @ts-ignore\r\n                tags: doc.tags,\r\n                submittedAt: doc.createdAt || new Date(), // Fallback\r\n                owner: vaultOwner\r\n            })\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-8 space-y-8\">\r\n            <div>\r\n                <h1 className=\"text-3xl font-bold text-slate-900\">Verification Queue</h1>\r\n                <p className=\"text-slate-500\">\r\n                    Documents routed to <strong>{org.name}</strong> based on tags:\r\n                    <span className=\"font-mono text-xs ml-2 bg-slate-200 px-2 py-1 rounded\">{relevantTags.join(\", \")}</span>\r\n                </p>\r\n            </div>\r\n\r\n            {tasks.length === 0 ? (\r\n                <div className=\"text-center py-12 bg-white rounded-lg border border-dashed border-slate-300\">\r\n                    <p className=\"text-slate-500\">No pending documents matching your ministry's jurisdiction.</p>\r\n                </div>\r\n            ) : (\r\n                <div className=\"grid gap-4\">\r\n                    {tasks.map((task: any) => (\r\n                        <Card key={task.docId} className=\"border-l-4 border-l-teal-500 shadow-sm hover:shadow-md transition-shadow\">\r\n                            <CardContent className=\"p-6 flex items-center justify-between\">\r\n                                <div className=\"flex items-start gap-4\">\r\n                                    <div className=\"h-10 w-10 rounded bg-teal-50 flex items-center justify-center text-teal-600\">\r\n                                        <FileText className=\"h-6 w-6\" />\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"font-bold text-slate-900\">{task.title}</h3>\r\n                                        <p className=\"text-sm text-slate-500\">\r\n                                            Submitted by: <span className=\"font-medium\">{task.owner?.email || \"Unknown\"}</span> (NIN: {task.owner?.nin})\r\n                                        </p>\r\n                                        <div className=\"flex gap-2 mt-2\">\r\n                                            <Badge variant=\"outline\">{task.type}</Badge>\r\n                                            {task.tags.map((t: string) => (\r\n                                                <Badge key={t} variant=\"secondary\" className=\"text-xs\">{t}</Badge>\r\n                                            ))}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex items-center gap-3\">\r\n                                    <Button variant=\"outline\" className=\"text-red-600 hover:bg-red-50 hover:text-red-700 border-red-200\">\r\n                                        <X className=\"mr-2 h-4 w-4\" /> Reject\r\n                                    </Button>\r\n                                    <Button className=\"bg-teal-600 hover:bg-teal-700 text-white\">\r\n                                        <Check className=\"mr-2 h-4 w-4\" /> Verify\r\n                                    </Button>\r\n                                </div>\r\n                            </CardContent>\r\n                        </Card>\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}