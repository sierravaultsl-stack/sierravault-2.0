{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/lib/superbaseClient.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabase = createClient(\r\n    process.env.SUPABASE_URL!,\r\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\r\n);"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,WAAW,IAAA,mQAAY,EAChC,QAAQ,GAAG,CAAC,YAAY,EACxB,QAAQ,GAAG,CAAC,yBAAyB"}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/USER/Desktop/A10%20Projects/SierraVaultMain/app/api/gov/upload/route.ts"],"sourcesContent":["// app/api/gov/upload/route.ts\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { supabase } from \"@/lib/superbaseClient\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        // Auth Check (Gov Only)\r\n        const issuerRole = req.headers.get('x-user-role');\r\n        if (issuerRole !== 'gov' && issuerRole !== 'official' && issuerRole !== 'associate') {\r\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n        }\r\n\r\n        const formData = await req.formData();\r\n        const file = formData.get(\"file\") as File;\r\n\r\n        if (!file) {\r\n            return NextResponse.json({ error: \"Missing file\" }, { status: 400 });\r\n        }\r\n\r\n        // Convert File to Buffer\r\n        const buffer = Buffer.from(await file.arrayBuffer());\r\n\r\n        // Generate unique filename\r\n        const filename = `gov/${Date.now()}-${file.name}`;\r\n\r\n        // Upload to Supabase bucket \"documents\"\r\n        const { data, error: uploadError } = await supabase.storage\r\n            .from(\"documents\")\r\n            .upload(filename, buffer, { contentType: file.type });\r\n\r\n        if (uploadError) {\r\n            console.error(\"Supabase gov upload error:\", uploadError);\r\n            return NextResponse.json({ error: uploadError.message }, { status: 500 });\r\n        }\r\n\r\n        const fileUrl = `${process.env.SUPABASE_URL}/storage/v1/object/public/documents/${filename}`;\r\n\r\n        return NextResponse.json({\r\n            message: \"Uploaded successfully\",\r\n            url: fileUrl,\r\n            filename: file.name\r\n        });\r\n\r\n    } catch (err: any) {\r\n        console.error(\"Gov Upload error:\", err);\r\n        return NextResponse.json({ error: err.message }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":"AAAA,8BAA8B;;;;;AAC9B;AACA;;;AAEO,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,wBAAwB;QACxB,MAAM,aAAa,IAAI,OAAO,CAAC,GAAG,CAAC;QACnC,IAAI,eAAe,SAAS,eAAe,cAAc,eAAe,aAAa;YACjF,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,MAAM,WAAW,MAAM,IAAI,QAAQ;QACnC,MAAM,OAAO,SAAS,GAAG,CAAC;QAE1B,IAAI,CAAC,MAAM;YACP,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,yBAAyB;QACzB,MAAM,SAAS,OAAO,IAAI,CAAC,MAAM,KAAK,WAAW;QAEjD,2BAA2B;QAC3B,MAAM,WAAW,CAAC,IAAI,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,IAAI,EAAE;QAEjD,wCAAwC;QACxC,MAAM,EAAE,IAAI,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,oIAAQ,CAAC,OAAO,CACtD,IAAI,CAAC,aACL,MAAM,CAAC,UAAU,QAAQ;YAAE,aAAa,KAAK,IAAI;QAAC;QAEvD,IAAI,aAAa;YACb,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO,YAAY,OAAO;YAAC,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,MAAM,UAAU,GAAG,QAAQ,GAAG,CAAC,YAAY,CAAC,oCAAoC,EAAE,UAAU;QAE5F,OAAO,+QAAY,CAAC,IAAI,CAAC;YACrB,SAAS;YACT,KAAK;YACL,UAAU,KAAK,IAAI;QACvB;IAEJ,EAAE,OAAO,KAAU;QACf,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO,IAAI,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnE;AACJ"}}]
}